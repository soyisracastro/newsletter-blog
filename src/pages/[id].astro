---
import type { InferGetStaticPropsType } from 'astro';
import { getCollection, render } from 'astro:content';
import Layout from '../layouts/Layout.astro';

export async function getStaticPaths() {
  const newsletters = await getCollection('newsletters');
  return newsletters.map((nl) => ({
    params: { id: nl.id.replace(/^\d{4}-\d{2}-\d{2}-/, '') },
    props: { newsletter: nl },
  }));
}

type Props = InferGetStaticPropsType<typeof getStaticPaths>;
const { newsletter } = Astro.props;
const { Content } = await render(newsletter);
---

<Layout
  title={`${newsletter.data.title} - Columna 13`}
  description={newsletter.data.description}
>
  <article class="max-w-2xl mx-auto px-6 py-16">
    <header class="mb-10">

      <h1 class="tape-title text-3xl mt-6 mb-4">{newsletter.data.title}</h1>

      <time class="block text-sm text-neutral-400">
        {newsletter.data.pubDate.toLocaleDateString('es-MX', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
        })}
      </time>
    </header>

    <div class="prose prose-lg prose-neutral max-w-none">
      <Content />
    </div>

    <footer class="mt-16 pt-8 border-t border-neutral-200">
      <p class="text-sm text-neutral-400">
        Quieres recibir estos newsletters?
        <a href="/" class="underline hover:text-neutral-800 transition">
          Suscribete aqui
        </a>
      </p>
    </footer>
  </article>
</Layout>
